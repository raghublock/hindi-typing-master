<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Professional Hindi Typing Master</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 10px; }
        .container { max-width: 1150px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); min-height: 95vh; display: flex; flex-direction: column; }
        
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .tab-btn { padding: 12px 25px; border: none; background: #eee; cursor: pointer; font-weight: bold; border-radius: 5px; font-size: 16px; }
        .tab-btn.active { background: #1a73e8; color: white; }

        /* Page 1: Advanced Learning Section */
        .trick-section { text-align: left; line-height: 1.6; }
        .trick-card { background: #fff; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #e0e0e0; box-shadow: 2px 2px 10px rgba(0,0,0,0.05); }
        .trick-card h3 { margin-top: 0; color: #1a73e8; border-bottom: 2px solid #e8f0fe; padding-bottom: 10px; }
        .mnemonic { font-weight: bold; color: #d32f2f; background: #fff3f3; padding: 4px 8px; border-radius: 4px; border: 1px dashed #d32f2f; font-size: 1.1em; }
        .finger-guide { color: #2e7d32; font-weight: 600; margin-top: 10px; display: block; }
        .story { font-style: italic; color: #555; background: #f9f9f9; padding: 10px; border-radius: 5px; margin-top: 10px; border-left: 3px solid #ccc; }

        /* Page 2: Practice */
        #practice-page { display: none; flex-grow: 1; flex-direction: column; }
        .controls { background: #2c3e50; color: white; padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .stat-box { background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 5px; text-align: center; }
        .display-section { border: 2px solid #3498db; border-radius: 8px; padding: 20px; background: #fff; margin-bottom: 10px; flex-grow: 1; overflow-y: auto; }
        .target-box { font-size: 26px; line-height: 1.8; color: #333; text-align: justify; word-break: break-all; }
        #input-field { width: 100%; font-size: 22px; padding: 15px; border: 2px solid #bdc3c7; border-radius: 8px; height: 120px; resize: none; margin-top: 10px; }
        #input-field.wrong { background: #ffdada; border-color: #e74c3c; }

        /* Keyboard */
        .keyboard-area { background: #333; padding: 15px; border-radius: 10px; margin-top: auto; }
        .row { display: flex; justify-content: center; margin-bottom: 5px; gap: 5px; }
        .key { background: #fff; width: 60px; height: 55px; border-radius: 5px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; position: relative; border-bottom: 4px solid #bbb; }
        .key .shift-char { color: #d32f2f; font-size: 11px; position: absolute; top: 3px; right: 5px; }
        .key .main-char { font-size: 19px; }
        .key .eng-hint { font-size: 9px; color: #888; position: absolute; bottom: 2px; left: 4px; }
        .active-key { background: #ffeb3b !important; transform: translateY(2px); box-shadow: 0 0 10px #ffeb3b; }
        .shift-active { background: #ff5722 !important; color: white !important; }
    </style>
</head>
<body>

<div class="container">
    <div class="tabs">
        <button class="tab-btn active" onclick="showPage('learn')">ЁЯУЦ рдпрд╛рдж рдХрд░рдиреЗ рдХреА рдЯреНрд░рд┐рдХреНрд╕</button>
        <button class="tab-btn" onclick="showPage('practice')">тМия╕П рдЯрд╛рдЗрдкрд┐рдВрдЧ рдкреНрд░реИрдХреНрдЯрд┐рд╕</button>
    </div>

    <div id="learn-page" class="trick-section">
        <h2 style="text-align: center; color: #1a73e8;">ЁЯОп рдЗрдирд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреАрдмреЛрд░реНрдб рдХреЛ рдпрд╛рдж рдХрд░рдиреЗ рдХреА "рд╢реЙрд░реНрдЯрдХрдЯ рдХрд╣рд╛рдирд┐рдпрд╛рдБ"</h2>
        
        <div class="trick-card">
            <h3>ЁЯПа рд╣реЛрдо рд░реЛ (рдордзреНрдп рд░реЗрдЦрд╛): "рдХрд▓ рд░рд╛рдЬрд╛ рддрдХ рдкрд╣реБрдБрдЪрд╛"</h3>
            <p>рдЙрдВрдЧрд▓рд┐рдпрд╛рдВ <b>ASDF</b> (рдорд╛рддреНрд░рд╛рдПрдВ) рдФрд░ <b>JKL;</b> (рдЕрдХреНрд╖рд░) рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред</p>
            <p><span class="mnemonic">H J K L ;</span> тЮбя╕П <span class="mnemonic">рдк рд░ рдХ рдд рдЪ</span></p>
            <div class="story"><b>рдХрд╣рд╛рдиреА:</b> "<b>рдк</b>рд╣рд▓реЗ <b>рд░</b>рд╛рдЬрд╛ <b>рдХ</b>рд▓ <b>рдд</b>рдХ <b>рдЪ</b>рд▓рд╛ рдЧрдпрд╛ред"</div>
            <span class="finger-guide">ЁЯСЙ рджрд╛рдпреАрдВ рд╣рд╛рде рдХреА рдЙрдВрдЧрд▓рд┐рдпрд╛рдВ рдпрд╣реАрдВ рд░рд╣реЗрдВрдЧреАред</span>
        </div>

        <div class="trick-card">
            <h3>тмЖя╕П рдЕрдкрд░ рд░реЛ (рдКрдкрд░реА рд░реЗрдЦрд╛): "рдмрд╕ рд╣реА рдЧрдИ рджреЗрд╢ рдХреА рдЬрдп"</h3>
            <p>рдЬрдм рдЖрдк рдКрдкрд░ рдХреА рд▓рд╛рдЗрди рдкрд░ рдЙрдВрдЧрд▓реА рд▓реЗ рдЬрд╛рдПрдВрдЧреЗ:</p>
            <p><span class="mnemonic">Y U I O P</span> тЮбя╕П <span class="mnemonic">рдм рд╣ рдЧ рдж рдЬ</span></p>
            <div class="story"><b>рдХрд╣рд╛рдиреА:</b> "<b>рдм</b>рд╕ <b>рд╣</b>реА <b>рдЧ</b>рдИ <b>рдж</b>реЗрд╢ рдХреА <b>рдЬ</b>рдпред"</div>
        </div>

        <div class="trick-card">
            <h3>тмЗя╕П рд▓реЛрдЕрд░ рд░реЛ (рдирд┐рдЪрд▓реА рд░реЗрдЦрд╛): "рдорди рд▓рдЧрд╛рдУ рд╕рдм рдХрд╛рдо рдореЗрдВ"</h3>
            <p>рдиреАрдЪреЗ рдХреА рд▓рд╛рдЗрди рдХреЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреЗ рд▓рд┐рдП:</p>
            <p><span class="mnemonic">C V B N M</span> тЮбя╕П <span class="mnemonic">рдо рди рд╡ рд▓ рд╕</span></p>
            <div class="story"><b>рдХрд╣рд╛рдиреА:</b> "<b>рдо</b>рди <b>рди</b>рд╣реАрдВ <b>рд╡</b>рд┐рдЪрд▓рд┐рдд, <b>рд▓</b>реЛ <b>рд╕</b>рдлрд▓рддрд╛ред"</div>
        </div>

        <div class="trick-card">
            <h3>тЬЛ рдмрд╛рдПрдВ рд╣рд╛рде рдХрд╛ рдЬрд╛рджреВ (рдорд╛рддреНрд░рд╛рдПрдВ)</h3>
            <p>рдмрд╛рдПрдВ рд╣рд╛рде рдХреА рдЙрдВрдЧрд▓рд┐рдпрд╛рдВ рд╣рдореЗрд╢рд╛ рдорд╛рддреНрд░рд╛рдУрдВ рдкрд░ рд░рд╣рддреА рд╣реИрдВ:</p>
            <p><span class="mnemonic">A S D F G</span> тЮбя╕П <span class="mnemonic">реЛ реЗ реН рд┐ реБ</span></p>
            <div class="story"><b>рдпрд╛рдж рд░рдЦреЗрдВ:</b> рдУ, рдП, рд╣рд▓рдВрдд, рдЗ, рдЙ (рдпрд╣ рдХреНрд░рдо рдорд╛рддреНрд░рд╛рдУрдВ рдХрд╛ рд╢реЙрд░реНрдЯрдХрдЯ рд╣реИ)ред <b>D</b> рдмрдЯрди рд╕рдмрд╕реЗ рдЬрд░реВрд░реА рд╣реИ, рдпрд╣ рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ <b>рдЖрдзрд╛</b> рдХрд░рддрд╛ рд╣реИред</div>
        </div>
    </div>

    <div id="practice-page">
        <div class="controls">
            <div class="stat-box">рд▓реЗрд╡рд▓ <select id="level-select" onchange="jumpToLevel()"></select></div>
            <div class="stat-box">рд╕рдордп (рдорд┐.) <input type="number" id="timer-input" value="5" style="width:45px;"></div>
            <button onclick="startTest()" style="background:#27ae60; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">рд╢реБрд░реВ рдХрд░реЗрдВ</button>
            <div class="stat-box">WPM: <span id="wpm-display" style="color:#f1c40f;">0</span></div>
            <div class="stat-box">рд╢реЗрд╖: <span id="time-display" style="color:#f1c40f;">00:00</span></div>
        </div>

        <div class="display-section">
            <div id="target" class="target-box">рд▓реЗрд╡рд▓ рдЪреБрдиреЗрдВ рдФрд░ 'рд╢реБрд░реВ рдХрд░реЗрдВ' рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ...</div>
            <textarea id="input-field" placeholder="рдЯрд╛рдЗрдкрд┐рдВрдЧ рдпрд╣рд╛рдБ рдХрд░реЗрдВ..." disabled autocomplete="off"></textarea>
        </div>

        <div class="keyboard-area" id="keyboard"></div>
    </div>
</div>

<script>
    const kbMap = { "рдХ":"k-K", "рд░":"k-J", "рдд":"k-L", "рдЪ":"k-Semi", "рдк":"k-H", "рдм":"k-Y", "рд╣":"k-U", "рдЧ":"k-I", "рдж":"k-O", "рдЬ":"k-P", "рдо":"k-C", "рди":"k-V", "рд╡":"k-B", "рд▓":"k-N", "рд╕":"k-M", "рд╛":"k-E", "рд┐":"k-F", "реА":"k-R", "реБ":"k-G", "реВ":"k-T", "реЛ":"k-A", "реЗ":"k-S", "реН":"k-D", " ": "k-Space" };

    const levels = [];
    const homeRow = ["рдХ", "рд░", "рдд", "рдЪ", "рдк"];
    const upperRow = ["рдм", "рд╣", "рдЧ", "рдж", "рдЬ"];
    const lowerRow = ["рдо", "рди", "рд╡", "рд▓", "рд╕"];
    const easyWords = ["рдХрд▓", "рдкрд╡рди", "рдирдордХ", "рдЬрдЧрдд", "рд╕рд░рд▓", "рдордЧрд░", "рдмрджрд▓", "рд╢рд╣рд░"];
    
    // рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛ 61-100 рдХреЗ рд▓рд┐рдП (рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╖рдпреЛрдВ рдкрд░)
    const paraData = [
        "рд░рд╛рдЬрд╕реНрдерд╛рди рднрд╛рд░рдд рдХрд╛ рдХреНрд╖реЗрддреНрд░рдлрд▓ рдХреА рджреГрд╖реНрдЯрд┐ рд╕реЗ рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рд░рд╛рдЬреНрдп рд╣реИред рдЗрд╕рдХреА рдкрд╢реНрдЪрд┐рдореА рд╕реАрдорд╛ рдкрд╛рдХрд┐рд╕реНрддрд╛рди рд╕реЗ рд▓рдЧрддреА рд╣реИред рдерд╛рд░ рдХрд╛ рдорд░реБрд╕реНрдерд▓ рдпрд╣рд╛рдБ рдХреА рдореБрдЦреНрдп рднреМрдЧреЛрд▓рд┐рдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИред рдмреАрдХрд╛рдиреЗрд░ рд╢рд╣рд░ рд░рд╛рд╡ рдмреАрдХрд╛рдЬреА рджреНрд╡рд╛рд░рд╛ рдмрд╕рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред",
        "рдЕрд░рд╛рд╡рд▓реА рдкрд░реНрд╡рддрдорд╛рд▓рд╛ рд╡рд┐рд╢реНрд╡ рдХреА рд╕рдмрд╕реЗ рдкреНрд░рд╛рдЪреАрди рдкрд░реНрд╡рдд рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред рдпрд╣ рд░рд╛рдЬрд╕реНрдерд╛рди рдХреЛ рджреЛ рднрд╛рдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреА рд╣реИред рдорд╛рдЙрдВрдЯ рдЖрдмреВ рдпрд╣рд╛рдБ рдХрд╛ рдкреНрд░рд╕рд┐рджреНрдз рд╣рд┐рд▓ рд╕реНрдЯреЗрд╢рди рд╣реИ рдЬрд╣рд╛рдБ рдирдХреНрдХреА рдЭреАрд▓ рд╕реНрдерд┐рдд рд╣реИред",
        "рдмреАрдХрд╛рдиреЗрд░ рдХреА рднреБрдЬрд┐рдпрд╛ рдФрд░ рдкрд╛рдкрдбрд╝ рдкреВрд░реА рджреБрдирд┐рдпрд╛ рдореЗрдВ рдкреНрд░рд╕рд┐рджреНрдз рд╣реИрдВред рдпрд╣рд╛рдБ рдХрд╛ рдЬреВрдирд╛рдЧрдврд╝ рдХрд┐рд▓рд╛ рдЕрдкрдиреА рдмреЗрд╣рддрд░реАрди рдирдХреНрдХрд╛рд╢реА рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрд░рдгреА рдорд╛рддрд╛ рдХрд╛ рдордВрджрд┐рд░ рджреЗрд╢рдиреЛрдХ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ рдЬрд╣рд╛рдБ рд╕рдлреЗрдж рдЪреВрд╣реЗ рдкрд╡рд┐рддреНрд░ рдорд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВред",
        "рдорд╣рд╛рд░рд╛рдгрд╛ рдкреНрд░рддрд╛рдк рдиреЗ рдореБрдЧрд▓реЛрдВ рдХреЗ рд╡рд┐рд░реБрджреНрдз рд╣рд▓реНрджреАрдШрд╛рдЯреА рдХреЗ рдпреБрджреНрдз рдореЗрдВ рдЕрджрдореНрдп рд╕рд╛рд╣рд╕ рдХрд╛ рдкрд░рд┐рдЪрдп рджрд┐рдпрд╛ рдерд╛ред рдЪреЗрддрдХ рдЙрдирдХрд╛ рд╕рдмрд╕реЗ рд╡рдлрд╛рджрд╛рд░ рдШреЛрдбрд╝рд╛ рдерд╛ рдЬрд┐рд╕рдиреЗ рдЕрдкрдиреА рдЬрд╛рди рджреЗрдХрд░ рдкреНрд░рддрд╛рдк рдХреА рд░рдХреНрд╖рд╛ рдХреА рдереАред",
        "рдЬрдпрдкреБрд░ рдХреЛ рдЧреБрд▓рд╛рдмреА рдирдЧрд░реА рдХреЗ рдирд╛рдо рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реЗ рд╕рд╡рд╛рдИ рдЬрдпрд╕рд┐рдВрд╣ рджреНрд╡рд┐рддреАрдп рдиреЗ рдмрд╕рд╛рдпрд╛ рдерд╛ред рд╣рд╡рд╛ рдорд╣рд▓ рдФрд░ рдЖрдореЗрд░ рдХрд╛ рдХрд┐рд▓рд╛ рдпрд╣рд╛рдБ рдХреЗ рдкреНрд░рдореБрдЦ рдкрд░реНрдпрдЯрди рд╕реНрдерд▓ рд╣реИрдВ рдЬреЛ рд╡рд┐рд╢реНрд╡ рдзрд░реЛрд╣рд░ рд╕реВрдЪреА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред",
        "рдХрдВрдкреНрдпреВрдЯрд░ рдЖрдЬ рдХреЗ рдпреБрдЧ рдХреА рдЕрдирд┐рд╡рд╛рд░реНрдп рдЖрд╡рд╢реНрдпрдХрддрд╛ рдмрди рдЧрдпрд╛ рд╣реИред рд╕рд░рдХрд╛рд░реА рдкрд░реАрдХреНрд╖рд╛рдУрдВ рдореЗрдВ рдЯрд╛рдЗрдкрд┐рдВрдЧ рджрдХреНрд╖рддрд╛ рдХрд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡ рд╣реИред рдирд┐рд░рдВрддрд░ рдЕрднреНрдпрд╛рд╕ рд╕реЗ рд╣реА рдЧрддрд┐ рдФрд░ рд╢реБрджреНрдзрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред",
        "рдЪрд┐рддреНрддреМрдбрд╝рдЧрдврд╝ рдХрд╛ рдХрд┐рд▓рд╛ рд░рд╛рдЬрд╕реНрдерд╛рди рдХреЗ рдЧреМрд░рд╡ рдФрд░ рдмрд▓рд┐рджрд╛рди рдХрд╛ рдкреНрд░рддреАрдХ рд╣реИред рд░рд╛рдиреА рдкрджреНрдорд┐рдиреА рдХрд╛ рдЬреМрд╣рд░ рдФрд░ рдкрдиреНрдирд╛рдзрд╛рдп рдХрд╛ рдмрд▓рд┐рджрд╛рди рдпрд╣рд╛рдБ рдХреА рдорд┐рдЯреНрдЯреА рдореЗрдВ рд░рдЪрд╛-рдмрд╕рд╛ рд╣реИред рд╡рд┐рдЬрдп рд╕реНрддрдВрдн рдпрд╣рд╛рдБ рдХреА рдореБрдЦреНрдп рдкрд╣рдЪрд╛рди рд╣реИред",
        "рд╢рд┐рдХреНрд╖рд╛ рдЬреАрд╡рди рдХрд╛ рдЖрдзрд╛рд░ рд╣реИред рд░рд╛рдЬрд╕реНрдерд╛рди рд╕рд░рдХрд╛рд░ рдиреЗ рд╢рд┐рдХреНрд╖рд╛ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЕрдиреЗрдХ рдХрд▓реНрдпрд╛рдгрдХрд╛рд░реА рдпреЛрдЬрдирд╛рдПрдВ рдЪрд▓рд╛рдИ рд╣реИрдВред REET рдФрд░ рд╢рд┐рдХреНрд╖рдХ рднрд░реНрддреА рдкрд░реАрдХреНрд╖рд╛рдПрдВ рдпреБрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реБрдирд╣рд░реЗ рдЕрд╡рд╕рд░ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВред",
        "рдерд╛рд░ рдорд░реБрд╕реНрдерд▓ рдореЗрдВ рдКрдБрдЯ рдХреЛ рд░реЗрдЧрд┐рд╕реНрддрд╛рди рдХрд╛ рдЬрд╣рд╛рдЬ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдорд░реБ рдорд╣реЛрддреНрд╕рд╡ рдЬреИрд╕рд▓рдореЗрд░ рдореЗрдВ рдЖрдпреЛрдЬрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдКрдБрдЯреЛрдВ рдХреА рджреМрдбрд╝ рдФрд░ рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЖрдХрд░реНрд╖рдг рдХрд╛ рдХреЗрдВрджреНрд░ рд╣реЛрддреЗ рд╣реИрдВред",
        "рд▓реВрдгреА рдирджреА рдкрд╢реНрдЪрд┐рдореА рд░рд╛рдЬрд╕реНрдерд╛рди рдХреА рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирджреА рд╣реИред рдпрд╣ рдЕрдЬрдореЗрд░ рдХреЗ рдирд┐рдХрдЯ рдирд╛рдЧ рдкрд╣рд╛рдбрд╝реА рд╕реЗ рдирд┐рдХрд▓рддреА рд╣реИред рдмрд╛рдбрд╝рдореЗрд░ рдХреЗ рдмрд╛рд▓реЛрддрд░рд╛ рддрдХ рдЗрд╕рдХрд╛ рдкрд╛рдиреА рдореАрдард╛ рд░рд╣рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЦрд╛рд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред"
        // рдХреЛрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдХрд╛рд░рдг рдпрд╣рд╛рдБ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ, рдиреАрдЪреЗ рд▓реВрдк рдЗрд╕реЗ 100 рддрдХ рдмреЭрд╛ рджреЗрдЧрд╛ред
    ];
    
    for(let i=1; i<=100; i++) {
        if(i <= 10) levels.push(Array(15).fill().map(() => homeRow[Math.floor(Math.random()*5)]).join(" "));
        else if(i <= 20) levels.push(Array(15).fill().map(() => upperRow[Math.floor(Math.random()*5)]).join(" "));
        else if(i <= 30) levels.push(Array(15).fill().map(() => lowerRow[Math.floor(Math.random()*5)]).join(" "));
        else if(i <= 40) levels.push("реЛ реЗ реН рд┐ реБ рдХ рд░ рдд рдк рд▓ рд╕ рди рдо".split(" ").sort(() => .5-Math.random()).join(" "));
        else if(i <= 60) levels.push(Array(10).fill().map(() => easyWords[Math.floor(Math.random()*easyWords.length)]).join(" "));
        else if(i <= 80) {
            let p = paraData[i % paraData.length];
            levels.push((p + " ").repeat(Math.ceil(500 / p.length))); // ~500 words
        } else {
            let p = paraData[i % paraData.length];
            levels.push((p + " ").repeat(Math.ceil(1500 / p.length))); // ~1500 words
        }
    }

    let currentLvl = 0, timerInterval, startTime, totalSecs;

    function showPage(p) {
        document.getElementById('learn-page').style.display = (p==='learn')?'block':'none';
        document.getElementById('practice-page').style.display = (p==='practice')?'flex':'none';
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.currentTarget.classList.add('active');
    }

    const select = document.getElementById('level-select');
    for(let i=1; i<=100; i++) { let opt = document.createElement('option'); opt.value = i-1; opt.text = i; select.add(opt); }

    function jumpToLevel() { currentLvl = parseInt(select.value); updateUI(); }

    function startTest() {
        totalSecs = document.getElementById('timer-input').value * 60;
        document.getElementById('input-field').disabled = false;
        document.getElementById('input-field').value = "";
        document.getElementById('input-field').focus();
        startTime = new Date();
        updateUI();
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            totalSecs--;
            let m = Math.floor(totalSecs/60), s = totalSecs%60;
            document.getElementById('time-display').innerText = `${m}:${s<10?'0'+s:s}`;
            let w = document.getElementById('input-field').value.length / 5;
            let timePassed = (new Date() - startTime) / 60000;
            document.getElementById('wpm-display').innerText = Math.round(w/timePassed) || 0;
            if(totalSecs <= 0) { clearInterval(timerInterval); document.getElementById('input-field').disabled = true; alert("рд╕рдордп рд╕рдорд╛рдкреНрдд!"); }
        }, 1000);
    }

    function updateUI() { document.getElementById('target').innerText = levels[currentLvl]; highlight(); }

    function highlight() {
        document.querySelectorAll('.key').forEach(k => k.classList.remove('active-key'));
        let next = levels[currentLvl][document.getElementById('input-field').value.length];
        let id = kbMap[next] || (next === " " ? "k-Space" : null);
        if(id) document.getElementById(id).classList.add('active-key');
    }

    document.getElementById('input-field').addEventListener('input', function() {
        let t = levels[currentLvl];
        if(this.value === t) { currentLvl++; select.value = currentLvl; this.value = ""; updateUI(); }
        this.className = t.startsWith(this.value) ? "" : "wrong";
        highlight();
    });

    const layout = [[{l:'Q',n:'реЛ',s:'реМ'},{l:'W',n:'реЗ',s:'реИ'},{l:'E',n:'рд╛',s:'рд╛'},{l:'R',n:'рд┐',s:'реА'},{l:'T',n:'реБ',s:'реВ'},{l:'Y',n:'рдм',s:'рдн'},{l:'U',n:'рд╣',s:'рдЩ'},{l:'I',n:'рдЧ',s:'рдШ'},{l:'O',n:'рдж',s:'рдз'},{l:'P',n:'рдЬ',s:'рдЭ'}],[{l:'A',n:'реЛ',s:'рдУ'},{l:'S',n:'реЗ',s:'рдП'},{l:'D',n:'реН',s:'рдЕ'},{l:'F',n:'рд┐',s:'рдЗ'},{l:'G',n:'реБ',s:'рдЙ'},{l:'H',n:'рдк',s:'рдл'},{l:'J',n:'рд░',s:'реНрд░'},{l:'K',n:'рдХ',s:'рдЦ'},{l:'L',n:'рдд',s:'рде'},{l:';',n:'рдЪ',s:'рдЫ'}],[{l:'Shift',id:'k-Shift',w:'90px'},{l:'Z',n:'реЗ',s:'рд╢'},{l:'X',n:'рдВ',s:'рдБ'},{l:'C',n:'рдо',s:'рдг'},{l:'V',n:'рди',s:'рди'},{l:'B',n:'рд╡',s:'рд╡'},{l:'N',n:'рд▓',s:'рд│'},{l:'M',n:'рд╕',s:'рд╖'},{l:',',n:'рдп',s:'рдп'}]];
    let kbHtml = "";
    layout.forEach(row => {
        kbHtml += '<div class="row">';
        row.forEach(key => {
            if(key.l === 'Shift') kbHtml += `<div class="key" id="k-Shift" style="width:${key.w}">Shift</div>`;
            else {
                let id = "k-" + (key.l === ';' ? "Semi" : key.l);
                kbHtml += `<div class="key" id="${id}"><span class="shift-char">${key.s}</span><span class="main-char">${key.n}</span><span class="eng-hint">${key.l}</span></div>`;
            }
        });
        kbHtml += '</div>';
    });
    kbHtml += '<div class="row"><div class="key" id="k-Space" style="width:300px;">Space</div></div>';
    document.getElementById('keyboard').innerHTML = kbHtml;
</script>
</body>
</html>
